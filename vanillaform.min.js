function VanillaForm(e){var t=function(e){return e.map((function(e,t){var n=function(e){var t={settings:e.settings};return Object.assign(t,e.settings),t.name||(t.name=`field_${e.index}`),t.label||(t.label=`Label ${e.index}`),t.type||(t.type="text"),(t.fields||t.repeater||t.branches||t.components)&&(t.type=null),t}({settings:e,index:t}),l=JSON.stringify(n);return l=JSON.parse(l),n.condition&&(l.condition=n.condition),l}))},n=function(e,t,n){var l=document.createElement("button");return l.classList.add("vanillaform__rmbtn"),l.innerText="×",l.addEventListener("click",(function(e){e.preventDefault(),t.childrens.splice(n,1),a.render()})),e.appendChild(l),!0},l=function(e,t){var n=document.createElement("div");n.classList.add("vanillaform__dragplaceholder");var l=document.createElement("button");l.classList.add("vanillaform__dragbtn"),l.innerText="⋮";var i=null,r=null,s=null,d=0,c=0,u=function(l){l.preventDefault(),i=e.getBoundingClientRect(),r=i.y||i.top,e.style.top=`${l.clientY+c}px`,e.style.left=`${l.clientX+d}px`,e.style.zIndex="2",s&&clearTimeout(s),s=setTimeout((function(){var l=[];for(let t=0;t<e.parentElement.children.length;t++)l.push(e.parentElement.children[t]);l=l.filter((function(e){return e!=n})),l=l.map((function(e,t){return e.indexOfSameType=t,e}));for(let v=0;v<l.length;v++){var i=l[v],a=i.getBoundingClientRect(),s=a.y||a.top,d=e.indexOfSameType,c=i.indexOfSameType,u=s>r&&c<d,o=s<r&&c>d;if((u||o)&&(u&&i.before(e),o&&e.before(i),e.before(n),t)){var p=t.childrens[c],f=t.childrens[d];t.childrens[c]=f,t.childrens[d]=p}}}),10)},o=function(e){e.preventDefault(),document.removeEventListener("mousemove",u),document.removeEventListener("mouseup",o),a.render()};return l.addEventListener("mousedown",(function(t){t.preventDefault(),document.addEventListener("mousemove",u),document.addEventListener("mouseup",o),i=e.getBoundingClientRect(),e.classList.add("vanillaform__dragging");var l=i.x||i.left,a=i.y||i.top;d=l-t.clientX,c=a-t.clientY,n.style.width=`${i.width}px`,n.style.height=`${i.height}px`,e.style.position="fixed",e.style.top=`${t.clientY+c}px`,e.style.left=`${t.clientX+d}px`,e.style.width=`${i.width}px`,e.style.height=`${i.height}px`,e.before(n)})),l.addEventListener("click",(function(e){e.preventDefault()})),e.appendChild(l),!0},i=function(e){var c=e.fields,u=document.createElement("div"),o=e.current_depth||0;e.class&&u.classList.add(e.class);for(let M=0;M<c.length;M++)if("function"!=typeof c[M].condition||c[M].condition({el:s,settings:r,fields:d})){var p=document.createElement("div");p.classList.add("vanillaform__field"),c[M].class&&p.classList.add(c[M].class);var f=c[M].name;o>0&&(f=`[${f}]`),e.prefix_fields_name&&(f=e.prefix_fields_name+f);var v=c[M].value?c[M].value:null;if("hidden"!=c[M].type){var h=document.createElement("label");h.classList.add("vanillaform__label"),h.innerText=c[M].label,h.setAttribute("for",f),p.appendChild(h)}if(c[M].fields||c[M].components||c[M].repeater||c[M].branches){if(p.classList.add("vanillaform__field--has-subfield"),c[M].fields)(b=i({fields:c[M].fields,prefix_fields_name:`${f}`,current_depth:o+1})).classList.add("vanillaform__fields"),p.appendChild(b);if(c[M].childrens){var m=document.createElement("div");m.classList.add("vanillaform__subfields_wrapper");for(let e=0;e<c[M].childrens.length;e++){var b;(b=i({fields:c[M].childrens[e],prefix_fields_name:`${f}[${e}]`,current_depth:o+1})).classList.add("vanillaform__subfield"),n(b,c[M],e),l(b,c[M]),m.appendChild(b)}p.appendChild(m)}else c[M].childrens=[];var _=document.createElement("button");if(_.classList.add("vanillaform__addbtn"),_.innerText="+",c[M].repeater){var g=t(c[M].settings.repeater);_.addEventListener("click",(function(e){e.preventDefault(),c[M].childrens.push(g),a.render()})),p.appendChild(_)}else if(c[M].components){g=t(c[M].settings.components);var y=document.createElement("select");for(let e=0;e<g.length;e++){var E=document.createElement("option");E.innerText=g[e].label,E.setAttribute("value",e),y.appendChild(E)}_.addEventListener("click",(function(e){e.preventDefault();var t=g[y.value];c[M].childrens.push([t]),a.render()}));var L=document.createElement("div");L.classList.add("vanillaform__componentsaction"),L.appendChild(y),L.appendChild(_),p.appendChild(L)}else if(c[M].branches){var x=c[M].childrens_label||"Add Childrens",A=c[M].childrens_name||"childrens",C=(g=t(c[M].settings.branches),t([{label:x,childrens_label:x,name:A,childrens_name:A,branches:t(g)}]));g.push(C[0]),_.addEventListener("click",(function(e){e.preventDefault(),c[M].childrens.push(g),a.render()})),p.appendChild(_)}}else if(c[M].type){if("textarea"==c[M].type||"wysiwyg"==c[M].type)(O=document.createElement("textarea")).setAttribute("name",f),O.setAttribute("id",f),O.addEventListener("input",(function(){c[M].value=this.value})),c[M].watch&&O.addEventListener("change",(function(){a.render()})),v&&(O.innerHTML=v);else if("image"==c[M].type||"file"==c[M].type){var $=document.createElement("input");$.setAttribute("type","file"),$.setAttribute("id",f),$.classList.add("vanillaform__inputfile");var k=document.createElement("img");k.setAttribute("src",""),k.classList.add("vanillaform__img__preview"),$.addEventListener("change",(function(){if(r.endpoints.upload&&$.files.length>0){let t=new FormData;t.append("file",$.files[0]);var e=new XMLHttpRequest;e.onload=function(t){r.callbacks.on_upload_response&&(r.callbacks.on_upload_response(e.response,w),w.dispatchEvent(new Event("change")))},e.open("POST",r.endpoints.upload,!0),e.send(t)}}));var T=document.createElement("label");T.setAttribute("for",f),T.innerText=c[M].button_label?c[M].button_label:"Select a file",T.classList.add("vanillaform__inputfilelabel");var w=document.createElement("input");w.setAttribute("type","hidden"),w.setAttribute("name",f),v&&(w.value=v),w.addEventListener("change",(function(){var e=this.value;c[M].value=e,k.setAttribute("src",e)})),w.dispatchEvent(new Event("change")),(O=document.createElement("div")).appendChild(w),O.appendChild(k),O.appendChild($),O.appendChild(T)}else if("checkbox"==c[M].type||"radio"==c[M].type||"select"==c[M].type){var O=null;"select"==c[M].type?((O=document.createElement("select")).addEventListener("input",(function(){var e=this.value;c[M].multiple?("object"!=typeof c[M].value&&(c[M].value=[]),this.selected&&-1==c[M].value.indexOf(e)&&c[M].value.push(e),this.selected||(c[M].value=c[M].value.filter((function(t){return t!=e})))):c[M].value=e})),O.addEventListener("change",(function(){a.render()}))):(O=document.createElement("div")).classList.add("vanillaform__group"),"checkbox"==c[M].type?c[M].multiple=!0:"radio"==c[M].type&&(c[M].multiple=!1),"select"==c[M].type&&c[M].multiple?(O.setAttribute("name",`${f}[]`),O.setAttribute("multiple","")):"select"==c[M].type&&O.setAttribute("name",`${f}`);var D=c[M].choices;for(let e=0;e<D.length;e++){var S=D[e],j="",R="";if("string"==typeof S?(j=S,R=S):"object"==typeof S&&(j=S.label,R=S.value),"select"==c[M].type){(X=document.createElement("option")).setAttribute("value",R),X.innerText=j,(c[M].multiple&&v&&v.indexOf(R)>-1||v==R)&&X.setAttribute("selected",""),O.appendChild(X)}else{var X,B=document.createElement("div");B.classList.add(`vanillaform__${c[M].type}`),(X=document.createElement("input")).setAttribute("type",c[M].type),X.setAttribute("value",R),X.setAttribute("id",`${f}[${e}]`),X.addEventListener("change",(function(){a.render()})),X.addEventListener("input",(function(){var e=this.value;c[M].multiple?("object"!=typeof c[M].value&&(c[M].value=[]),this.checked&&-1==c[M].value.indexOf(e)&&c[M].value.push(e),this.checked||(c[M].value=c[M].value.filter((function(t){return t!=e})))):c[M].value=e})),c[M].multiple?(X.setAttribute("name",`${f}[]`),v&&v.indexOf(R)>-1&&X.setAttribute("checked","")):(X.setAttribute("name",`${f}`),v==R&&X.setAttribute("checked","")),B.appendChild(X);var H=document.createElement("label");H.innerText=j,H.setAttribute("for",`${f}[${e}]`),B.appendChild(H),O.appendChild(B)}}}else{(O=document.createElement("input")).setAttribute("type",c[M].type),O.setAttribute("name",f),O.setAttribute("id",f),O.addEventListener("input",(function(){c[M].value=this.value})),c[M].watch&&O.addEventListener("change",(function(){a.render()})),v&&O.setAttribute("value",v)}p.appendChild(O)}u.appendChild(p)}return u},a={},r=e,s=r.el,d=t(r.fields);return a.set_values=function(e,n){var l=n||d;for(let n=0;n<l.length;n++){var i=e[l[n].name];if(l[n].fields&&i)a.set_values(i,l[0].fields);else if(l[n].repeater&&i){l[n].childrens||(l[n].childrens=[]);for(var r=0;r<i.length;r++){var s=i[r],c=t(l[n].settings.repeater);l[n].childrens.push(c)}for(r=0;r<i.length;r++){var u=l[n].childrens[r];a.set_values(i[r],l[n].childrens[r])}}else if(l[n].components&&i){for(r=0;r<i.length;r++){s=i[r];var o=Object.keys(s),p=null;c=t(l[n].settings.components);for(let e=0;e<c.length;e++)c[e].name==o[0]&&(p=c[e]);p&&(l[n].childrens||(l[n].childrens=[]),l[n].childrens.push([p]))}for(r=0;r<i.length;r++){u=l[n].childrens[r];a.set_values(i[r],u)}}else if(l[n].branches&&i){var f=l[n].childrens_label||"Add Childrens",v=l[n].childrens_name||"childrens";l[n].childrens||(l[n].childrens=[]);for(r=0;r<i.length;r++){s=i[r],c=t(l[n].settings.branches);var h=t([{label:f,childrens_label:f,name:v,childrens_name:v,branches:t(c)}]);c.push(h[0]),l[n].childrens.push(c)}for(r=0;r<i.length;r++){u=l[n].childrens[r];a.set_values(i[r],u)}}else l[n].type&&(l[n].value=i)}return a},a.render=function(){a.callbacks&&"function"==typeof a.callbacks.before_render&&a.callbacks.before_render();var e=i({fields:d,class:"vanillaform__content"}),t=document.createElement("div");t.classList.add("vanillaform__submit");var n=document.createElement("button");n.setAttribute("type","submit"),n.innerText=r.submit_btn_label||"Submit",t.appendChild(n),e.appendChild(t);var l=document.createElement("form");return l.classList.add("vanillaform"),l.setAttribute("method",r.method||"post"),r.endpoints&&l.setAttribute("action",r.endpoints.action||""),l.appendChild(e),s.innerHTML="",s.appendChild(l),a.callbacks&&"function"==typeof a.callbacks.after_render&&a.callbacks.after_render(),a},a}